{% extends "base.html" %}

{% block content %}
<div class="container">
    <a href="{{ url_for('index') }}" class="back-link">
        <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Home
    </a>
    
    <div class="profile-header">
        <div class="profile-info">
            <div class="profile-avatar">
                <i class="fas fa-user"></i>
            </div>
            <h1>{{ user.username }}</h1>
            <p><i class="fas fa-envelope"></i> {{ user.email }}</p>
            <p><i class="fas fa-tv"></i> Channel: {{ user.channel }}</p>
            {% if bio %}
                <div class="bio-section">
                    <p class="bio-text">{{ bio }}</p>
                </div>
            {% endif %}
        </div>
        
        <form method="POST" class="bio-form">
            <div class="form-group">
                <label for="bio">Bio</label>
                <textarea name="bio" id="bio" class="form-control" placeholder="Tell us about yourself..." maxlength="500">{{ bio }}</textarea>
            </div>
            <button type="submit" class="btn btn-primary">Update Profile</button>
        </form>
    </div>

    <div class="profile-posts">
        <h2><i class="fas fa-blog"></i> My Posts ({{ blogs|length }})</h2>
        
        {% if blogs %}
            <div class="blog-grid">
                {% for blog in blogs %}
                <div class="blog-card">
                    <h3><a href="{{ url_for('view_blog', blog_id=blog.id) }}">{{ blog.title|safe }}</a></h3>
                    <div class="blog-meta">
                        <i class="fas fa-calendar"></i> {{ blog.date }}
                        <span class="channel-badge">{{ blog.channel }}</span>
                    </div>
                    <div class="blog-content">
                        {{ blog.content[:150]|safe }}
                        {% if blog.content|length > 150 %}...{% endif %}
                    </div>
                    {% if blog.images and blog.images|length > 0 %}
                    <div class="blog-image-preview">
                        <img src="/static/uploads/{{ blog.images[0] }}" alt="{{ blog.title|safe }}" style="max-width: 200px; height: auto; border-radius: 6px; margin-top: 12px;">
                    </div>
                    {% endif %}
                    <div class="card-actions">
                        <a href="{{ url_for('view_blog', blog_id=blog.id) }}" class="read-more-btn">
                            <i class="fas fa-book-open"></i> Read More
                        </a>
                        {% if current_user == blog.author %}
                        <a href="{{ url_for('edit_blog', blog_id=blog.id) }}" class="action-btn" style="background: #28a745;">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form method="POST" action="{{ url_for('delete_blog', blog_id=blog.id) }}" style="display: inline;" 
                              onsubmit="return confirm('Are you sure you want to delete this blog?')">
                            <button type="submit" class="action-btn" style="background: #dc3545;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </form>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-posts">
                <i class="fas fa-pen-alt"></i>
                <h3>No posts yet</h3>
                <p>Start sharing your thoughts with the world!</p>
                <a href="{{ url_for('create_blog') }}" class="btn btn-primary">Create First Post</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}